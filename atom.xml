<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>逝殇_Vizard...</title>
  <subtitle>我以为人生很漫长,匆匆翻看,却再也无法逆转</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://yoursite.com/"/>
  <updated>2017-05-12T13:10:56.000Z</updated>
  <id>http://yoursite.com/</id>
  
  <author>
    <name>_Vizard战国</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>fastlane的使用</title>
    <link href="http://yoursite.com/2017/05/12/fastlane%E7%9A%84%E4%BD%BF%E7%94%A8/"/>
    <id>http://yoursite.com/2017/05/12/fastlane的使用/</id>
    <published>2017-05-12T12:41:51.000Z</published>
    <updated>2017-05-12T13:10:56.000Z</updated>
    
    <content type="html"><![CDATA[<p>对于一个iOS APP的发布上线，一般来说都需要经历:<br>编译打包 -&gt; 截图 -&gt; 填写一些说明文字 -&gt; 上传ipa到itunes connect -&gt; 提交供审核。<br>每次都要进行这么多“繁琐”的步骤，对于某些步骤可能一次还不能执行成功需要等着界面提示上传错误然后手动重新再来一次。</p>
<p>在日常开发中，打包也是最后上线不可缺少的环节，如果需要生成ipa文件通常需要在Xcode里<br>点击Product -&gt; Archive，然后在弹出来的Organizer中选择导出什么类型(ad hoc/enterprise)的包。对于大项目来说动辄编译十分钟以上的来说，一天打几个包就差不多过去了。</p>
<p>为了解决这些问题，Felix Krause大神写了一个工具集fastlane。<br>fastlane是一套使用Ruby写的自动化工具集，用于iOS和Android自动化打包和发布.</p>
<p><img src="http://blog.devzeng.com/images/ios-fastlane-in-action/fastlane-logo.png" alt="image"></p>
<h2 id="fastlane-的安装"><a href="#fastlane-的安装" class="headerlink" title="fastlane 的安装"></a>fastlane 的安装</h2><p>1.首先确保安装的 xcode 命令行是最新的<br>   如果尚未安装可使用下面命令安装</p>
<pre><code>xcode-select --install
</code></pre><p> 2.安装fastlane</p>
<pre><code>    sudo gem install fastlane
部分人的mac会提示
*ERROR:  While executing gem ... (Errno::EPERM)
               Operation not permitted - /usr/bin/rougify
               *
</code></pre><p>  原因正如提示所说,可以使用下面的命令进行安装</p>
<pre><code>sudo gem install -n /usr/local/bin fastlane
</code></pre><h4 id="当出现如下一大坨时候表示安装成功了"><a href="#当出现如下一大坨时候表示安装成功了" class="headerlink" title="当出现如下一大坨时候表示安装成功了."></a>当出现如下一大坨时候表示安装成功了.</h4><p> <img src="http://ww1.sinaimg.cn/large/006tNbRwgy1ffivh5ki06j30wi0p4gue.jpg" alt=""></p>
<p> 3.fastlane组件<br> fastlane是一个工具集，包含了我们日常开发中上线时需要的大部分操作。比如gym/deliver等。下面对每个工具进行介绍：</p>
<pre><code>名称    说明
deliver    自动上传截图，APP的元数据，二进制(ipa)文件到iTunes Connect
snapshot    自动截图（基于Xcode7的UI test）
frameit    可以把截的图片自动套上一层外边框
pem    自动生成、更新推送配置文件
 sigh    用来创建、更新、下载、修复Provisioning Profile的工具
 produce    如果你的产品还没在iTunes Connect(iTC)或者Apple Developer Center(ADC)建立，produce可以自动帮你完成这些工作
 cert    自动创建管理iOS代码签名证书
 pilot    管理TestFlight的测试用户，上传二进制文件
 boarding    建立一个添加测试用户界面，发给测试者，可自行添加邮件地址，并同步到iTunes Connect(iTC)
gym    自动化编译打包工具
match    证书和配置文件管理工具
scan    自动运行测试工具，并且可以生成漂亮的HTML报告
</code></pre><p>4.fastlane核心概念<br>在运行fastlane命令行工具的时候，会读取当前目录下面的fastlane文件夹里面的Fastfile配置文件。里面定义了一个个的lane，下面是官方提供的一个示例：</p>
<pre><code>lane :beta do
increment_build_number
cocoapods
match
testflight
sh &quot;./customScript.sh&quot;
slack
end
</code></pre><p>像<em>increment_build_number</em>、<em>cocoapods</em>这样的一条命令都是一个action，<br>由这样的一个个action组成了一个lane（lane中可以调用其他的lane)。</p>
<h3 id="fastlane实战"><a href="#fastlane实战" class="headerlink" title="fastlane实战"></a>fastlane实战</h3><p>1、初始化<br>在项目的根目录下面，执行fastlane init命令开始初始化。<br>在执行的过程中会要求填写一些项目的资料，如Apple ID等，fastlane会自动检测当前目录下项目的App Name和App Identifier，可以选择自行输入这些信息。初始化完成会在当前目录下面生成一个fastlane的文件夹。</p>
<p><img src="http://blog.devzeng.com/images/ios-fastlane-in-action/fastlane-init.png" alt=""></p>
<p>最重要的两个文件就是Appfile和Fastfile，主要的说明如下：</p>
<p>（1）Appfile里面存放了App的基本信息包括app_identifier、apple_id、team_id等，如果在init的时候输入了正确的apple_id和密码会自动获取team_id。</p>
<p>（2）Fastfile是最重要的一个文件，在这个里面可以编写和定制我们的自动化脚本，所有的流程控制功能都写在这个文件里面。</p>
<p>说明：</p>
<p>（1）如果在init的时候选择了在iTunes Connect创建App，那么fastlane会调用produce进行初始化，如果没有创建后续可以手动执行produce init进行创建。如果没有在初始化的时候选择执行produce流程当然deliver也不会执行，后面可以使用deliver init运行是一样的。</p>
<p>（2）在iTunes Connect中成功创建App之后，fastlane文件夹里面会生成一个Deliverfile的文件。Deliverfile文件主要是deliver的一些配置信息。</p>
<p>2、Fastfile文件<br>Fastfile文件的主要结构如下所示：</p>
<pre><code>fastlane_version &quot;2.14.2&quot;
default_platform :ios

platform :ios do
before_all do
       cocoapods
  end

  lane :test do
  end

  lane :beta do
  end

  lane :release do
  end

  after_all do |lane|

  end

  error do |lane, exception|

          end
end
</code></pre><p>说明：</p>
<p>（1）fastlane_version：指定fastlane使用的最小版本<br>（2）default_platform：指定当前默认的平台，可以选择ios/android/mac<br>（3）before_all：在执行每一个lane之前都会调用这部分的内容<br>（4）after_all：在每个lane执行完成之后都会执行这部分的内容<br>（5）error：每个lane执行出错就会执行这部分的内容<br>（6）desc：对lane的描述，fastlane会自动将desc的内容生成说明文档<br>（7）lane：定义一个lane(任务)，可以理解为一个函数，我们在执行的时候使用fastlane [ios] lane名称</p>
<p>3、Fastfile文件的编写</p>
<pre><code>lane :release do |option|
#根据传入参数version设置app的版本号
increment_version_number(version_number: option[:version])
#自动增加build号
increment_build_number
#证书签名
sigh
#编译打包
scheme_name = option[:scheme]
configuration = &apos;Release&apos;
version = get_info_plist_value(path: &quot;./#{scheme_name}/Info.plist&quot;, key: &quot;CFBundleShortVersionString&quot;)
build = get_info_plist_value(path: &quot;./#{scheme_name}/Info.plist&quot;, key: &quot;CFBundleVersion&quot;)
output_directory = File.expand_path(&quot;..&quot;, Dir.pwd) + File::Separator + &apos;build&apos;
output_name = &quot;#{scheme_name}_#{configuration}_#{version}_#{build}_#{Time.now.strftime(&apos;%Y%m%d%H%M%S&apos;)}.ipa&quot;
gym(scheme: scheme_name, clean: true, export_method:&apos;appstore&apos;, configuration: configuration, output_directory: output_directory, output_name: output_name)
</code></pre><p>  end</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;对于一个iOS APP的发布上线，一般来说都需要经历:&lt;br&gt;编译打包 -&amp;gt; 截图 -&amp;gt; 填写一些说明文字 -&amp;gt; 上传ipa到itunes connect -&amp;gt; 提交供审核。&lt;br&gt;每次都要进行这么多“繁琐”的步骤，对于某些步骤可能一次还不能执行成功
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>这迷雾到底怎么冲破</title>
    <link href="http://yoursite.com/2017/05/11/%E8%BF%99%E8%BF%B7%E9%9B%BE%E5%88%B0%E5%BA%95%E6%80%8E%E4%B9%88%E5%86%B2%E7%A0%B4/"/>
    <id>http://yoursite.com/2017/05/11/这迷雾到底怎么冲破/</id>
    <published>2017-05-11T09:05:00.000Z</published>
    <updated>2017-05-11T14:15:34.000Z</updated>
    
    <summary type="html">
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>iOS 10 Charles 抓 HTTPS 的包的</title>
    <link href="http://yoursite.com/2017/05/11/%E5%AE%89%E5%BE%97%E5%B9%BF%E5%8E%A6%E5%8D%83%E4%B8%87%E9%97%B4/"/>
    <id>http://yoursite.com/2017/05/11/安得广厦千万间/</id>
    <published>2017-05-11T08:50:15.000Z</published>
    <updated>2017-05-11T14:15:34.000Z</updated>
    
    <content type="html"><![CDATA[<h3 id="这里只说与之前不同的地方-不说之前的-mobile-证书安装之类的"><a href="#这里只说与之前不同的地方-不说之前的-mobile-证书安装之类的" class="headerlink" title="这里只说与之前不同的地方,不说之前的 mobile 证书安装之类的:"></a>这里只说与之前不同的地方,不说之前的 mobile 证书安装之类的:</h3><h3 id="当你想-iOS10以下的一样设置完发现还是不能在-iOS10上抓-HTTPS-百感交集啊"><a href="#当你想-iOS10以下的一样设置完发现还是不能在-iOS10上抓-HTTPS-百感交集啊" class="headerlink" title="当你想 iOS10以下的一样设置完发现还是不能在 iOS10上抓 HTTPS 百感交集啊"></a>当你想 iOS10以下的一样设置完发现还是不能在 iOS10上抓 HTTPS 百感交集啊</h3><h4 id="解决办法"><a href="#解决办法" class="headerlink" title="解决办法:"></a>解决办法:</h4><pre><code>来到设置-&gt;关于本机-&gt;证书信任设置
</code></pre><p><img src="http://ww2.sinaimg.cn/large/006tKfTcgy1ffhqmimwyxj309w0hmdgc.jpg" alt=""></p>
]]></content>
    
    <summary type="html">
    
      &lt;h3 id=&quot;这里只说与之前不同的地方-不说之前的-mobile-证书安装之类的&quot;&gt;&lt;a href=&quot;#这里只说与之前不同的地方-不说之前的-mobile-证书安装之类的&quot; class=&quot;headerlink&quot; title=&quot;这里只说与之前不同的地方,不说之前的 mobile 
    
    </summary>
    
    
  </entry>
  
</feed>
